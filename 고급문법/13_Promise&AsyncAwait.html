<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Promise & Async/Await</title>
</head>
<body>
    <script>
        // const promise = new Promise((resolve, reject) => {
        //     if(/*처리 성공*/) {
        //         resolve("결과 데이터");
        //     } else {
        //         reject(new Error("에러"));
        //     }
        // });

        //XMLHttpRequest 비동기 통신
        // function getData() {
        //     const xhr = new XMLHttpRequest(); //XMLHttpRequest 객체 생성
        //     xhr.open("GET", "https://jsonplaceholder.typicode.com/posts/1"); //HTTP Method, URL 정의
        //     xhr.setRequestHeader("content-type", "application/json"); //헤더 값 중 content-type 정의
        //     xhr.send(); // 요청 전송

        //     xhr.onload = () => {
        //         if (xhr.status === 200) {
        //             // 정상적으로 응답되면 status가 200
        //             const res = JSON.parse(xhr.reponse); // 응답 데이터를 JSON.parse 함수의 JSON 객체로 변경
        //             console.log(res);
        //             return res;
        //         } else {
        //             // 에러 발생
        //             console.error(xhr.status, xhr.statusText); // 응답 상태와 응답 메시지 출력
        //             return;
        //         }
        //     };
        // }

        // const res = getData(); // 함수 호출
        // console.log(res); // 코드가 바로 실행되고, 이 시점에는 서버로부터 응답이 오지 않은 시점이기 때문에 undefined
        // console.log("다음 코드를 실행합니다.");

        //Promise tkdyd
        // function getDataPromise() {
        //     return new Promise((resolve, reject) => {
        //         const xhr = new XMLHttpRequest();
        //         xhr.open("GET", "https://jsonplaceholder.typicode.com/posts/1");
        //         xhr.setRequestHeader("content-type", "application/json");
        //         xhr.send();

        //         xhr.onload = () => {
        //             if (xhr.status === 200) {
        //                 const res = JSON.parse(xhr.response);
        //                 resolve(res);
        //             } else {
        //                 console.error(xhr.status, xhr.statusText);
        //                 reject(new Error(xhr.status));
        //             }
        //         };
        //     });
        // }

        // getDataPromise().then((res) => {
        //     console.log(res);
        //     console.log("다음 코드를 실행합니다");
        // });

        //Async/Await
        // function myFunction() { 
        //     fetch("https://jsonplaceholder.typicode.com/posts/1")
        //     .then((reponse) => response.json())
        //     .then((json) => {
        //         console.log(json);
        //         // 코드 구현
        //     });
        // }

        async function myFunction() {
            const res1 = await fetch(
                "https://jsonplaceholder.typicode.com/posts/1");
            const res1Json = await res1.json();
            console.log(res1Json);
            
            const res2 = await fetch(
                "https://jsonplaceholder.typicode.com/posts/1", {
                    method: "PUT",
                    body: JSON.stringify({
                        id: 1,
                        title: "foo",
                        body: "bar",
                        userId: 1,
                    }),
                    headers: {
                        "content-type": "application/json; charset=UTF-8",
                    },
                }   
            );
            const res2Json = await res2.json();
            console.log(res2Json);
        }
    </script>
</body>
</html>